{% extends 'base.html' %}
{% block content %}
<h2>Order History</h2>

{% for order in orders %}
<div class="card mb-3">
  <div class="card-body">
    <h5>Order #{{ order.id }} - {{ order.created_at|date:"SHORT_DATE_FORMAT" }}</h5>
    <p>Status: {{ order.status }} | Payment: {{ order.payment_method }}</p>
    <p>Total: ${{ order.total_price }}</p>
    <p>Address: {{ order.address }}</p>

    <hr>
    <h6>Items:</h6>
    <ul class="list-group">
      {% for item in order.orderitem_set.all %}
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <div>
          <a href="{% url 'product_detail' item.product.pk%}"> <strong>{{ item.product.name }}</strong><br></a>
          {% if order.status == "Completed" %}
          <a href="{% url 'product_detail' item.product.pk %}">Add a review</a><br>
          {% endif %}
          Quantity: {{ item.quantity }}<br>
          Price: ${{ item.price }}<br>
          Subtotal: ${{ item.subtotal }}
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
</div>
{% empty %}
<p>No orders yet.</p>
{% endfor %}
{% endblock %}
